<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="<?!= include('styles'); ?>">
  </head>
  <body>
    <div class="container">
      <h1>Gestionnaire de Règles Réseau</h1>
      
      <div id="rulesContainer">
        <div class="rule-line">
          <div class="form-group">
            <label>IP Source</label>
            <input type="text" class="sourceIp" required pattern="^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$">
            <div class="btn-add-container">
              <button type="button" class="btn-add" onclick="addRule('source')" title="Ajouter source">+</button>
            </div>
          </div>
          
          <div class="form-group">
            <label>IP Destination</label>
            <input type="text" class="destinationIp" required pattern="^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$">
            <div class="btn-add-container">
              <button type="button" class="btn-add" onclick="addRule('destination')" title="Ajouter destination">+</button>
            </div>
          </div>
          
          <div class="form-group">
            <label>Protocole</label>
            <select class="protocol" required>
              <option value="ssh">SSH</option>
              <option value="https">HTTPS</option>
              <option value="ping">PING</option>
              <option value="smtp">SMTP</option>
            </select>
            <div class="btn-add-container">
              <button type="button" class="btn-add" onclick="addRule('protocol')" title="Ajouter protocole">+</button>
            </div>
          </div>
          
          <div class="form-group">
            <label>Port</label>
            <input type="number" class="port" required min="1" max="65535">
            <div class="btn-add-container">
              <button type="button" class="btn-add" onclick="addRule('port')" title="Ajouter port">+</button>
            </div>
          </div>
        </div>
      </div>
      
      <div class="btn-container">
        <button type="button" class="btn-secondary" onclick="verifyRules()">Vérifier</button>
        <button type="button" class="btn-primary" onclick="saveRules()">Enregistrer</button>
      </div>
      
      <div class="preview-container">
        <h2>Aperçu des règles</h2>
        <table id="previewTable">
          <thead>
            <tr>
              <th>Source IP</th>
              <th>Destination IP</th>
              <th>Protocole</th>
              <th>Port</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
    
    <div id="notification" class="notification hidden"></div>
    
    <script src="<?!= include('script'); ?>"></script>
  </body>
</html>